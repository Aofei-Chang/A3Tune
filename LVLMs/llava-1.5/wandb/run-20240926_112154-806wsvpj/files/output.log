  0%|                                                                                                                                                                                                                                                                               | 0/675 [00:00<?, ?it/s]/data/aofei/conda/env/llava_v1.5/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/data/aofei/conda/env/llava_v1.5/lib/python3.10/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
odict_keys(['last_hidden_state', 'attentions']) tensor([[[[8.6670e-03, 8.3923e-04, 1.3000e-02,  ..., 2.2221e-04,
           6.8665e-04, 2.1057e-03],
          [5.7617e-02, 6.8970e-03, 3.2959e-02,  ..., 1.0757e-03,
           1.0071e-03, 1.6861e-03],
          [2.4292e-02, 4.4861e-03, 1.5332e-01,  ..., 9.6130e-04,
           7.0572e-04, 1.8082e-03],
          ...,
          [2.5635e-03, 1.1978e-03, 2.5024e-03,  ..., 1.8921e-03,
           2.7100e-02, 8.5831e-04],
          [5.4932e-04, 1.9169e-04, 2.8419e-04,  ..., 3.8452e-03,
           6.8359e-02, 1.1108e-02],
          [9.2697e-04, 3.1662e-04, 4.3869e-04,  ..., 3.1281e-03,
           2.0312e-01, 7.7515e-03]],

         [[1.7383e-01, 2.6703e-03, 2.8534e-03,  ..., 1.9302e-03,
           6.2866e-03, 3.4943e-03],
          [8.7891e-03, 4.5166e-03, 3.1586e-03,  ..., 1.4420e-03,
           1.4801e-03, 1.6708e-03],
          [9.8877e-03, 6.4392e-03, 6.4087e-03,  ..., 2.5787e-03,
           3.3722e-03, 1.6937e-03],
          ...,
          [1.9302e-03, 1.4191e-03, 1.2283e-03,  ..., 3.0060e-03,
           9.7275e-04, 6.2561e-04],
          [1.1520e-03, 1.3580e-03, 8.5449e-04,  ..., 6.4392e-03,
           8.1177e-03, 1.3199e-03],
          [3.4180e-03, 3.1586e-03, 1.0376e-03,  ..., 1.3809e-03,
           3.9978e-03, 1.4746e-01]],

         [[6.5002e-03, 2.7771e-03, 1.7090e-03,  ..., 1.3733e-03,
           2.7466e-03, 3.0060e-03],
          [8.7280e-03, 2.2278e-03, 2.8839e-03,  ..., 2.0599e-03,
           1.4572e-03, 1.3885e-03],
          [1.3000e-02, 6.8665e-03, 5.4321e-03,  ..., 1.0834e-03,
           2.1515e-03, 2.4414e-03],
          ...,
          [2.3193e-03, 1.3580e-03, 1.6098e-03,  ..., 2.4414e-03,
           1.0986e-03, 8.4305e-04],
          [3.9062e-03, 1.2131e-03, 1.9379e-03,  ..., 2.5330e-03,
           3.4027e-03, 1.0986e-03],
          [2.4567e-03, 1.2970e-03, 1.6708e-03,  ..., 2.6703e-03,
           4.4556e-03, 3.0365e-03]],

         ...,

         [[5.8289e-03, 2.6512e-04, 1.2512e-03,  ..., 2.1362e-03,
           2.0599e-03, 9.2773e-03],
          [8.6914e-02, 4.3335e-03, 2.0294e-03,  ..., 3.7537e-03,
           2.7924e-03, 9.8877e-03],
          [1.0010e-01, 2.9297e-03, 8.3618e-03,  ..., 3.5400e-03,
           1.1520e-03, 3.8086e-02],
          ...,
          [5.4932e-04, 2.4915e-05, 2.4033e-04,  ..., 1.2939e-02,
           1.0757e-03, 1.3086e-01],
          [8.0872e-04, 1.0633e-04, 6.6757e-05,  ..., 4.2419e-03,
           2.1240e-02, 2.8906e-01],
          [1.1520e-03, 1.7548e-04, 1.2779e-04,  ..., 1.5747e-02,
           4.7119e-02, 1.0303e-01]],

         [[6.1798e-04, 1.8463e-03, 4.9591e-04,  ..., 2.8687e-03,
           5.1880e-03, 2.3346e-03],
          [5.6839e-04, 6.2866e-03, 1.8692e-04,  ..., 2.4261e-03,
           5.6458e-03, 2.1820e-03],
          [9.1553e-04, 5.2490e-03, 2.8610e-04,  ..., 1.7929e-03,
           6.0730e-03, 2.6855e-03],
          ...,
          [2.1210e-03, 8.0490e-04, 1.7319e-03,  ..., 8.6212e-04,
           1.9684e-03, 2.9373e-04],
          [2.6398e-03, 1.2741e-03, 1.1139e-03,  ..., 1.0223e-03,
           5.8594e-03, 4.1580e-04],
          [2.4414e-03, 1.6479e-03, 9.7656e-04,  ..., 1.2436e-03,
           1.0193e-02, 1.1520e-03]],

         [[8.9453e-01, 3.7575e-04, 4.4823e-04,  ..., 1.5354e-04,
           1.1444e-04, 1.3256e-04],
          [9.2163e-03, 1.0132e-02, 1.2329e-02,  ..., 1.5259e-03,
           1.6937e-03, 2.2888e-03],
          [7.7515e-03, 9.3384e-03, 1.2024e-02,  ..., 1.5869e-03,
           1.5793e-03, 2.1973e-03],
          ...,
          [1.5182e-03, 2.0142e-03, 1.5182e-03,  ..., 4.0588e-03,
           1.1215e-03, 1.7548e-03],
          [1.5030e-03, 2.1210e-03, 1.3428e-03,  ..., 8.9111e-03,
           3.2654e-03, 3.1891e-03],
          [1.6403e-03, 2.2278e-03, 1.4420e-03,  ..., 6.1951e-03,
           4.8218e-03, 5.8289e-03]]],


        [[[1.1047e-02, 1.0681e-03, 1.6602e-02,  ..., 7.5150e-04,
           7.5150e-04, 7.5150e-04],
          [5.4443e-02, 6.5002e-03, 3.1006e-02,  ..., 7.7438e-04,
           7.7438e-04, 7.7438e-04],
          [2.3193e-02, 4.3030e-03, 1.4648e-01,  ..., 8.2016e-04,
           8.2016e-04, 8.2016e-04],
          ...,
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04],
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04],
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04]],

         [[1.7285e-01, 2.6703e-03, 2.8381e-03,  ..., 1.4038e-03,
           1.4038e-03, 1.4038e-03],
          [8.6670e-03, 4.4556e-03, 3.1128e-03,  ..., 1.4343e-03,
           1.4343e-03, 1.4343e-03],
          [9.8267e-03, 6.3782e-03, 6.3477e-03,  ..., 1.6785e-03,
           1.6785e-03, 1.6785e-03],
          ...,
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04],
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04],
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04]],

         [[6.0425e-03, 2.5787e-03, 1.5945e-03,  ..., 1.4572e-03,
           1.4572e-03, 1.4572e-03],
          [9.2773e-03, 2.3804e-03, 3.0670e-03,  ..., 1.5869e-03,
           1.5869e-03, 1.5869e-03],
          [1.1902e-02, 6.2866e-03, 4.9744e-03,  ..., 1.2360e-03,
           1.2360e-03, 1.2360e-03],
          ...,
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04],
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04],
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04]],

         ...,

         [[6.4087e-03, 2.9373e-04, 1.3809e-03,  ..., 1.3046e-03,
           1.3046e-03, 1.3046e-03],
          [9.1797e-02, 4.5776e-03, 2.1362e-03,  ..., 4.5204e-04,
           4.5204e-04, 4.5204e-04],
          [1.1621e-01, 3.4027e-03, 9.7046e-03,  ..., 6.4850e-04,
           6.4850e-04, 6.4850e-04],
          ...,
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04],
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04],
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04]],

         [[6.1035e-04, 1.8158e-03, 4.8828e-04,  ..., 1.4496e-03,
           1.4496e-03, 1.4496e-03],
          [5.5313e-04, 6.1340e-03, 1.8311e-04,  ..., 1.6022e-03,
           1.6022e-03, 1.6022e-03],
          [8.9264e-04, 5.0964e-03, 2.7847e-04,  ..., 1.5793e-03,
           1.5793e-03, 1.5793e-03],
          ...,
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04],
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04],
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04]],

         [[8.9844e-01, 3.7766e-04, 4.4823e-04,  ..., 1.0395e-04,
           1.0395e-04, 1.0395e-04],
          [9.5215e-03, 1.0437e-02, 1.2695e-02,  ..., 1.7548e-03,
           1.7548e-03, 1.7548e-03],
          [8.0566e-03, 9.7046e-03, 1.2451e-02,  ..., 1.6861e-03,
           1.6861e-03, 1.6861e-03],
          ...,
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04],
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04],
          [1.5717e-03, 1.5717e-03, 1.5717e-03,  ..., 5.7602e-04,
           5.7602e-04, 5.7602e-04]]]], device='cuda:0', dtype=torch.bfloat16,
       grad_fn=<CheckpointFunctionBackward>)
/data/aofei/conda/env/llava_v1.5/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py:1652: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)
  total_norm_cuda = get_accelerator().FloatTensor([float(total_norm)])
  0%|‚ñç                                                                                                                                                                                                                                                                      | 1/675 [00:02<33:02,  2.94s/it]
{'loss': 4.5296, 'learning_rate': 9.523809523809523e-06, 'epoch': 0.0}
odict_keys(['last_hidden_state', 'attentions']) tensor([[[[9.6436e-03, 9.3460e-04, 1.4465e-02,  ..., 2.4567e-03,
           1.1520e-03, 2.6093e-03],
          [5.6396e-02, 6.7139e-03, 3.1982e-02,  ..., 7.2479e-04,
           1.0910e-03, 1.7929e-03],
          [2.3560e-02, 4.3640e-03, 1.4941e-01,  ..., 9.9182e-04,
           1.0147e-03, 2.1973e-03],
          ...,
          [2.8992e-04, 1.2302e-04, 1.5259e-04,  ..., 1.2598e-01,
           2.8687e-03, 8.0566e-03],
          [2.5635e-03, 1.1826e-03, 9.6130e-04,  ..., 1.2939e-02,
           3.6011e-03, 1.0147e-03],
          [8.6975e-04, 3.0708e-04, 3.8910e-04,  ..., 5.2979e-02,
           6.0425e-03, 9.0332e-03]],

         [[1.7773e-01, 2.7466e-03, 2.9144e-03,  ..., 7.2861e-04,
           1.2817e-03, 2.1362e-03],
          [9.0332e-03, 4.6387e-03, 3.2501e-03,  ..., 1.8768e-03,
           1.8845e-03, 2.0142e-03],
          [9.9487e-03, 6.4697e-03, 6.4392e-03,  ..., 2.5787e-03,
           1.6556e-03, 2.2125e-03],
          ...,
          [1.3580e-03, 1.8234e-03, 7.9346e-04,  ..., 4.2419e-03,
           1.6174e-03, 9.0027e-04],
          [2.0447e-03, 2.0599e-03, 1.1292e-03,  ..., 3.0823e-03,
           2.4109e-03, 1.1215e-03],
          [3.2654e-03, 3.2654e-03, 1.5259e-03,  ..., 2.9297e-03,
           1.5793e-03, 1.4941e-01]],

         [[6.6223e-03, 2.8229e-03, 1.7471e-03,  ..., 2.9602e-03,
           1.8158e-03, 2.8534e-03],
          [8.9111e-03, 2.2736e-03, 2.9297e-03,  ..., 1.1520e-03,
           1.5335e-03, 1.4496e-03],
          [1.3367e-02, 7.0496e-03, 5.5542e-03,  ..., 2.5635e-03,
           1.6861e-03, 2.5024e-03],
          ...,
          [3.0365e-03, 1.1673e-03, 1.5030e-03,  ..., 1.4267e-03,
           6.5231e-04, 7.6294e-04],
          [2.2125e-03, 1.9073e-03, 1.3504e-03,  ..., 2.1973e-03,
           1.8158e-03, 1.0071e-03],
          [2.7618e-03, 1.2665e-03, 1.3657e-03,  ..., 2.0752e-03,
           2.3193e-03, 3.0975e-03]],

         ...,

         [[6.3477e-03, 2.8992e-04, 1.3657e-03,  ..., 2.7618e-03,
           2.3041e-03, 9.8267e-03],
          [9.7168e-02, 4.8523e-03, 2.2736e-03,  ..., 3.8910e-03,
           2.0752e-03, 9.9487e-03],
          [1.1719e-01, 3.4332e-03, 9.7656e-03,  ..., 7.0496e-03,
           2.9907e-03, 4.3213e-02],
          ...,
          [5.7602e-04, 3.3855e-05, 9.3460e-05,  ..., 1.6479e-02,
           3.3417e-03, 3.4180e-01],
          [2.8610e-04, 9.0599e-06, 2.8229e-04,  ..., 1.2756e-02,
           7.5684e-03, 2.0020e-01],
          [1.2436e-03, 1.9550e-04, 1.3638e-04,  ..., 7.5195e-02,
           6.5918e-03, 1.0986e-01]],

         [[6.2943e-04, 1.8692e-03, 5.0354e-04,  ..., 1.9684e-03,
           3.0823e-03, 4.1504e-03],
          [5.7983e-04, 6.4087e-03, 1.9073e-04,  ..., 1.2436e-03,
           1.6022e-03, 2.6703e-03],
          [9.3842e-04, 5.3711e-03, 2.9373e-04,  ..., 1.3275e-03,
           1.6937e-03, 2.9449e-03],
          ...,
          [3.0212e-03, 1.2589e-03, 3.2043e-03,  ..., 6.8054e-03,
           3.3760e-04, 3.6240e-04],
          [2.5177e-03, 9.5367e-04, 3.6469e-03,  ..., 7.3547e-03,
           1.0986e-03, 3.2043e-04],
          [2.0447e-03, 4.7112e-04, 2.5787e-03,  ..., 8.9722e-03,
           1.4496e-03, 1.1826e-03]],

         [[8.9844e-01, 3.7956e-04, 4.5013e-04,  ..., 2.1935e-04,
           7.7248e-05, 1.0300e-04],
          [9.3384e-03, 1.0254e-02, 1.2451e-02,  ..., 1.9073e-03,
           8.0872e-04, 1.7471e-03],
          [7.8735e-03, 9.5215e-03, 1.2207e-02,  ..., 1.8463e-03,
           1.1902e-03, 1.8768e-03],
          ...,
          [8.3542e-04, 2.2278e-03, 1.8845e-03,  ..., 1.5030e-03,
           6.6833e-03, 2.4872e-03],
          [1.6174e-03, 1.8387e-03, 1.8616e-03,  ..., 2.2430e-03,
           8.6060e-03, 1.9684e-03],
          [1.6022e-03, 2.0294e-03, 1.6174e-03,  ..., 3.0975e-03,
           9.2773e-03, 5.8289e-03]]],


        [[[1.1597e-02, 1.1215e-03, 1.7456e-02,  ..., 7.8964e-04,
           7.8964e-04, 7.8964e-04],
          [5.3955e-02, 6.4697e-03, 3.0762e-02,  ..., 7.7057e-04,
           7.7057e-04, 7.7057e-04],
          [2.3071e-02, 4.2725e-03, 1.4551e-01,  ..., 8.1253e-04,
           8.1253e-04, 8.1253e-04],
          ...,
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04],
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04],
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04]],

         [[1.7676e-01, 2.7313e-03, 2.9144e-03,  ..., 1.4420e-03,
           1.4420e-03, 1.4420e-03],
          [8.7280e-03, 4.5166e-03, 3.1586e-03,  ..., 1.4496e-03,
           1.4496e-03, 1.4496e-03],
          [1.0193e-02, 6.6223e-03, 6.5613e-03,  ..., 1.7395e-03,
           1.7395e-03, 1.7395e-03],
          ...,
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04],
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04],
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04]],

         [[6.0425e-03, 2.5787e-03, 1.5869e-03,  ..., 1.4572e-03,
           1.4572e-03, 1.4572e-03],
          [9.7046e-03, 2.4719e-03, 3.1891e-03,  ..., 1.6556e-03,
           1.6556e-03, 1.6556e-03],
          [1.1780e-02, 6.2256e-03, 4.9133e-03,  ..., 1.2283e-03,
           1.2283e-03, 1.2283e-03],
          ...,
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04],
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04],
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04]],

         ...,

         [[6.3171e-03, 2.8801e-04, 1.3580e-03,  ..., 1.2817e-03,
           1.2817e-03, 1.2817e-03],
          [9.2285e-02, 4.5776e-03, 2.1515e-03,  ..., 4.5395e-04,
           4.5395e-04, 4.5395e-04],
          [1.1572e-01, 3.3875e-03, 9.6436e-03,  ..., 6.4850e-04,
           6.4850e-04, 6.4850e-04],
          ...,
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04],
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04],
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04]],

         [[5.9891e-04, 1.7929e-03, 4.8256e-04,  ..., 1.4267e-03,
           1.4267e-03, 1.4267e-03],
          [5.4169e-04, 6.0120e-03, 1.7929e-04,  ..., 1.5717e-03,
           1.5717e-03, 1.5717e-03],
          [8.6975e-04, 4.9744e-03, 2.7084e-04,  ..., 1.5411e-03,
           1.5411e-03, 1.5411e-03],
          ...,
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04],
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04],
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04]],

         [[8.9453e-01, 3.7766e-04, 4.4823e-04,  ..., 1.0395e-04,
           1.0395e-04, 1.0395e-04],
          [9.7046e-03, 1.0620e-02, 1.2939e-02,  ..., 1.7929e-03,
           1.7929e-03, 1.7929e-03],
          [8.1787e-03, 9.8877e-03, 1.2634e-02,  ..., 1.7166e-03,
           1.7166e-03, 1.7166e-03],
          ...,
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04],
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04],
          [1.5869e-03, 1.5869e-03, 1.5869e-03,  ..., 5.8365e-04,
           5.8365e-04, 5.8365e-04]]]], device='cuda:0', dtype=torch.bfloat16,
       grad_fn=<CheckpointFunctionBackward>)
